# SELECT DISTINCT 
#     PRODUCT_CODE,
#     SUM(PRICE * SALES_AMOUNT) OVER (PARTITION BY PRODUCT_ID) AS SALES
# FROM 
#     OFFLINE_SALE 
# JOIN 
#     PRODUCT USING (PRODUCT_ID)
# ORDER BY 
#     SALES DESC, 
#     PRODUCT_CODE ASC

SELECT
    PRODUCT_CODE,
    SUM(SALES_AMOUNT * PRICE) AS SALES
FROM
    OFFLINE_SALE
JOIN
    PRODUCT
USING (PRODUCT_ID)
GROUP BY
    PRODUCT_CODE
ORDER BY
    SALES DESC,
    PRODUCT_CODE ASC
    















