SELECT
    FLAVOR
FROM
    FIRST_HALF fh
JOIN
    ICECREAM_INFO ii
USING (FLAVOR)
WHERE
    ii.INGREDIENT_TYPE = 'fruit_based'
    AND
    fh.TOTAL_ORDER >= 3000
ORDER BY
    TOTAL_ORDER DESC